<!DOCTYPE html>
<html lang="en">
<head>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" type="text/css" href="/css/bootstrap/5.3.3/dist/css/bootstrap.css">
<link rel="stylesheet" type="text/css" href="/css/fontawesome/fontawesome-free-6.4.2-web/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/css/datatables/bs5/dt-1.13.6/datatables.min.css">
<link rel="stylesheet" type="text/css" href="/css/accumulo.css">

<title>Jshell Accumulo Feature</title>

<script type="text/javascript" src="/js/jquery/3.7.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/bootstrap/5.3.3/dist/js/bootstrap.bundle.js"></script>
<script type="text/javascript" src="/js/datatables/bs5/dt-1.13.6/datatables.min.js"></script>
<script type="text/javascript" src="https://www.apachecon.com/event-images/snippet.js"></script>
<script type="text/javascript" src="/js/accumulo.js"></script>
</head>
<body style="padding-top: 100px">

  <nav class="navbar navbar-expand-lg navbar-light fixed-top bg-light">
  <div class="container">
    <a class="navbar-brand" href="/">
      <img alt="Apache Accumulo" id="nav-logo" src="/images/accumulo-logo.png" width="200">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-items">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-items">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" href="/downloads">Download</a></li>
        <li class="nav-item"><a class="nav-link" href="/tour">Tour</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Releases</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="/release/accumulo-3.0.0/">3.0.0 (Latest non-LTM)</a></li>
            <li><a class="dropdown-item" href="/release/accumulo-2.1.2/">2.1.2 (Latest LTM)</a></li>
            <li><a class="dropdown-item" href="/release/accumulo-1.10.4/">1.10.4 (Legacy LTM)</a></li>
            <li><a class="dropdown-item" href="/release/">Archive</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Documentation</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="/docs/2.x">User Manual (2.x)</a></li>
            <li><a class="dropdown-item" href="/docs/2.x/apidocs">Javadocs (2.x)</a></li>
            <li><a class="dropdown-item" href="/api">Public API</a></li>
            <li><a class="dropdown-item" href="/quickstart-1.x">Quickstart (1.x)</a></li>
            <li><a class="dropdown-item" href="/accumulo2-maven-plugin">Accumulo Maven Plugin</a></li>
            <li><a class="dropdown-item" href="/1.10/accumulo_user_manual.html">User Manual (1.10)</a></li>
            <li><a class="dropdown-item" href="/1.10/apidocs">Javadocs (1.10)</a></li>
            <li><a class="dropdown-item" href="/external-docs">External Docs</a></li>
            <li><a class="dropdown-item" href="/docs-archive/">Archive</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Community</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="/contact-us">Contact Us</a></li>
            <li><a class="dropdown-item" href="/how-to-contribute">How To Contribute</a></li>
            <li><a class="dropdown-item" href="/people">People</a></li>
            <li><a class="dropdown-item" href="/related-projects">Related Projects</a></li>
          </ul>
        </li>
        <li class="nav-item"><a class="nav-link" href="/search">Search</a></li>
      </ul>
      <ul class="navbar-nav ms-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
            <img alt="Apache Software Foundation" src="https://www.apache.org/foundation/press/kit/feather.svg" width="15"/>
          </a>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="https://www.apache.org">Apache Homepage <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/licenses/">License <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship">Sponsorship <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/security">Security <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/foundation/thanks">Thanks <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/foundation/policies/privacy.html">Privacy Policy<span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/events/current-event.html">Current Event <span class="fa-solid fa-up-right-from-square"></span></a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>


  <div class="container">
    <div class="row">
      <div class="col-md-12">

        <div id="non-canonical" style="display: none; background-color: #F0E68C; padding-left: 1em;">
          Visit the official site at: <a href="https://accumulo.apache.org">https://accumulo.apache.org</a>
        </div>
        <div id="content">
          
          <h1 class="title">Jshell Accumulo Feature</h1>
          
          <p>

<b>Date: </b>&nbsp;&nbsp;21 Apr 2021<br>

</p>

<h2 id="overview">Overview</h2>

<p>First introduced in Java 9, <a href="https://docs.oracle.com/javase/9/jshell/introduction-jshell.htm#JSHEL-GUID-630F27C8-1195-4989-9F6B-2C51D46F52C8">JShell</a> is an interactive Read-Evaluate-Print-Loop (REPL)
Java tool that interprets user’s input and outputs the results. This tool provides a convenient
way to test out and execute quick tasks with Accumulo in the terminal. This feature is a part
of the upcoming Accumulo 2.1 release. If you’re a developer and want to get involved in testing,
<a href="/contact-us/">contact us</a> or review our <a href="/how-to-contribute/">contributing guide</a>.</p>

<h2 id="major-features">Major Features</h2>
<ul>
  <li>
    <p>Default JShell script provides initial imports for interacting with Accumulo’s API and
provided in Accumulo’s binary distribution tarball</p>
  </li>
  <li>
    <p>On startup, JShell Accumulo  will automatically import the <code class="language-plaintext highlighter-rouge">CLASSPATH</code>, load in a configured
environment from user’s <code class="language-plaintext highlighter-rouge">conf/accumulo-env.sh</code>, and invoke <code class="language-plaintext highlighter-rouge">conf/jshell-init.jsh</code>
to allow rapid Accumulo task executions</p>
  </li>
  <li>
    <p>JShell Accumulo can startup using default/custom JShell script and users can append any JShell
command-line <a href="https://docs.oracle.com/javase/9/tools/jshell.htm#JSWOR-GUID-C337353B-074A-431C-993F-60C226163F00">options</a> to the startup command</p>
  </li>
</ul>

<h2 id="booting-up-jshell-accumulo">Booting Up JShell Accumulo</h2>
<p>1) Open up a terminal and navigate to Accumulo’s installation directory</p>

<p>2) To startup JShell with <strong>default script</strong> use this command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bin/accumulo jshell
</code></pre></div></div>
<p>3) To startup JShell with <strong>custom script</strong> use this command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bin/accumulo jshell <span class="nt">--startup</span> file/path/to/custom_script.jsh
</code></pre></div></div>
<p><strong>Note:</strong> One can execute the <code class="language-plaintext highlighter-rouge">jshell</code> command to startup JShell. However, doing so will require
manually importing the <code class="language-plaintext highlighter-rouge">CLASSPATH</code> and the configured environment from <code class="language-plaintext highlighter-rouge">conf/accumulo-env.sh</code>
and manually specifying the startup file for <code class="language-plaintext highlighter-rouge">conf/jshell-init.jsh</code> before any Accumulo tasks
can be performed. Using one of the startup commands above will automate that process
for convenience.</p>

<h2 id="jshell-accumulo-default-script">JShell Accumulo Default Script</h2>
<p>The auto-generated <code class="language-plaintext highlighter-rouge">jshell-init.jsh</code> is a customizable file located in Accumulo’s installation
<code class="language-plaintext highlighter-rouge">conf/</code> directory. Inside, <code class="language-plaintext highlighter-rouge">jshell-init.jsh</code> contains <a href="/api/">Accumulo Java APIs</a>
formatted as import statements and <a href="https://www.javadoc.io/doc/org.apache.accumulo/accumulo-core/latest/org/apache/accumulo/core/client/AccumuloClient.html">AccumuloClient</a> build implementation. On startup,
the script automatically loads in the APIs and attempts to construct a client. Should additional
APIs and/or code implementations be needed, simply append them to <code class="language-plaintext highlighter-rouge">jshell-init.jsh</code>.
Alternatively, you can create a separate JShell script and specify the custom script’s file path
on startup.</p>

<p>To construct an <a href="https://www.javadoc.io/doc/org.apache.accumulo/accumulo-core/latest/org/apache/accumulo/core/client/AccumuloClient.html">AccumuloClient</a>, the provided <code class="language-plaintext highlighter-rouge">conf/jshell-init.jsh</code> script finds
and uses <code class="language-plaintext highlighter-rouge">accumulo-client.properties</code> in Accumulo’s class path, and assigns the result
to a variable called <strong>client</strong>.</p>

<p>If <code class="language-plaintext highlighter-rouge">accumulo-client.properties</code> is found, a similar result will be produced below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Preparing JShell for Apache Accumulo

Building Accumulo client using 'jar:file:/home/accumulo/lib/accumulo-client.jar!/accumulo-client.properties'

Use 'client' to interact with Accumulo

|  Welcome to JShell -- Version 11.0.10
|  For an introduction type: /help intro

jshell&gt;
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">accumulo-client.properties</code> is not found, an <a href="https://www.javadoc.io/doc/org.apache.accumulo/accumulo-core/latest/org/apache/accumulo/core/client/AccumuloClient.html">AccumuloClient</a> will not
auto-generate and will produce the following result below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Preparing JShell for Apache Accumulo

'accumulo-client.properties' was not found on the classpath

|  Welcome to JShell -- Version 11.0.10
|  For an introduction type: /help intro

jshell&gt;
</code></pre></div></div>

<h2 id="jshell-accumulo-example">JShell Accumulo Example</h2>
<p>1) Booting up JShell Accumulo using default script</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Preparing JShell for Apache Accumulo

Building Accumulo client using 'file:/home/accumulo/conf/accumulo-client.properties'

Use 'client' to interact with Accumulo

|  Welcome to JShell -- Version 11.0.10
|  For an introduction type: /help intro

jshell&gt;
</code></pre></div></div>

<p>2) Providing JShell with an Accumulo task</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// Create a table called "GothamPD".</span>
  <span class="n">client</span><span class="o">.</span><span class="na">tableOperations</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"GothamPD"</span><span class="o">);</span>

  <span class="c1">// Create a Mutation object to hold all changes to a row in a table.</span>
  <span class="c1">// Each row has a unique row ID.</span>
  <span class="nc">Mutation</span> <span class="n">mutation</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Mutation</span><span class="o">(</span><span class="s">"id0001"</span><span class="o">);</span>

  <span class="c1">// Create key/value pairs for Batman. Put them in the "hero" family.</span>
  <span class="n">mutation</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"hero"</span><span class="o">,</span> <span class="s">"alias"</span><span class="o">,</span> <span class="s">"Batman"</span><span class="o">);</span>
  <span class="n">mutation</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"hero"</span><span class="o">,</span> <span class="s">"name"</span><span class="o">,</span> <span class="s">"Bruce Wayne"</span><span class="o">);</span>
  <span class="n">mutation</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"hero"</span><span class="o">,</span> <span class="s">"wearsCape?"</span><span class="o">,</span> <span class="s">"true"</span><span class="o">);</span>

  <span class="c1">// Create a BatchWriter to the GothamPD table and add your mutation to it.</span>
  <span class="c1">// Try w/ resources will close for us.</span>
  <span class="k">try</span> <span class="o">(</span><span class="nc">BatchWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">createBatchWriter</span><span class="o">(</span><span class="s">"GothamPD"</span><span class="o">))</span> <span class="o">{</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">addMutation</span><span class="o">(</span><span class="n">mutation</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="c1">// Read and print all rows of the "GothamPD" table.</span>
  <span class="c1">// Try w/ resources will close for us.</span>
  <span class="k">try</span> <span class="o">(</span><span class="nc">ScannerBase</span> <span class="n">scan</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">createScanner</span><span class="o">(</span><span class="s">"GothamPD"</span><span class="o">,</span> <span class="nc">Authorizations</span><span class="o">.</span><span class="na">EMPTY</span><span class="o">))</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Gotham Police Department Persons of Interest:"</span><span class="o">);</span>

    <span class="c1">// A Scanner is an extension of java.lang.Iterable so behaves just like one.</span>
    <span class="n">scan</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">k</span><span class="o">,</span> <span class="n">v</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Key : %-50s Value : %s\n"</span><span class="o">,</span> <span class="n">k</span><span class="o">,</span> <span class="n">v</span><span class="o">));</span>
  <span class="o">}</span>
</code></pre></div></div>

<p><strong>Note:</strong> The fully-qualified class name for Accumulo Scanner or
<code class="language-plaintext highlighter-rouge">org.apache.accumulo.core.client.Scanner</code> needs to be used due to conflicting issues with
Java’s built-in java.util.Scanner. However, to shorten the Accumulo Scanner’s declaration, assign
scan to <code class="language-plaintext highlighter-rouge">ScannerBase</code> type instead.</p>

<p>3) Executing the Accumulo task above outputs:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mutation ==&gt; org.apache.accumulo.core.data.Mutation@1
Gotham Police Department Persons of Interest:
Key : id0001 hero:alias [] 1618926204602 false            Value : Batman
Key : id0001 hero:name [] 1618926204602 false             Value : Bruce Wayne
Key : id0001 hero:wearsCape? [] 1618926204602 false       Value : true

jshell&gt;
</code></pre></div></div>


<p><strong>View all posts in the <a href="/news">news archive</a></strong></p>

        </div>

        
<footer>

  <p><a href="https://www.apache.org/foundation/contributing"><img src="https://www.apache.org/images/SupportApache-small.png" alt="Support the ASF" id="asf-logo" height="100" /></a></p>

  <p>Copyright © 2011-2024 <a href="https://www.apache.org">The Apache Software Foundation</a>.
Licensed under the <a href="https://www.apache.org/licenses/">Apache License, Version 2.0</a>.</p>

  <p>Apache®, the names of Apache projects and their logos, and the multicolor feather
logo are registered trademarks or trademarks of The Apache Software Foundation
in the United States and/or other countries.</p>

</footer>


      </div>
    </div>
  </div>
</body>
</html>
