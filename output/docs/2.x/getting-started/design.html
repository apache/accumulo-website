<!DOCTYPE html>
<html lang="en">
<head>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs5/dt-1.13.6/datatables.min.css">
<link href="/css/accumulo.css" rel="stylesheet" type="text/css">

<title>Accumulo Documentation - Design</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.datatables.net/v/bs5/dt-1.13.6/datatables.min.js"></script>
<script type="text/javascript" src="https://www.apachecon.com/event-images/snippet.js"></script>
<script>
  // show location of canonical site if not currently on the canonical site
  $(function() {
    var host = window.location.host;
    if (typeof host !== 'undefined' && host !== 'accumulo.apache.org') {
      $('#non-canonical').show();
    }
  });

  $(function() {
    // decorate section headers with anchors
    return $("h2, h3, h4, h5, h6").not(".accordion-header").each(function(i, el) {
      var $el, icon, id;
      $el = $(el);
      id = $el.attr('id');
      icon = '<span class="fa-solid fa-link"></span>';
      if (id) {
        return $el.append($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));
      }
    });
  });

  // fix sidebar width in documentation
  $(function() {
    var $affixElement = $('div[data-spy="affix"]');
    $affixElement.width($affixElement.parent().width());
  });
</script>

</head>
<body style="padding-top: 100px">

  <nav class="navbar navbar-expand-lg navbar-light fixed-top bg-light">
  <div class="container">
    <a class="navbar-brand" href="/">
      <img alt="Apache Accumulo" id="nav-logo" src="/images/accumulo-logo.png" width="200">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-items">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-items">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" href="/downloads">Download</a></li>
        <li class="nav-item"><a class="nav-link" href="/tour">Tour</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Releases</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="/release/accumulo-3.0.0/">3.0.0 (Latest non-LTM)</a></li>
            <li><a class="dropdown-item" href="/release/accumulo-2.1.2/">2.1.2 (Latest LTM)</a></li>
            <li><a class="dropdown-item" href="/release/accumulo-1.10.4/">1.10.4 (Legacy LTM)</a></li>
            <li><a class="dropdown-item" href="/release/">Archive</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Documentation</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="/docs/2.x">User Manual (2.x)</a></li>
            <li><a class="dropdown-item" href="/docs/2.x/apidocs">Javadocs (2.x)</a></li>
            <li><a class="dropdown-item" href="/api">Public API</a></li>
            <li><a class="dropdown-item" href="/quickstart-1.x">Quickstart (1.x)</a></li>
            <li><a class="dropdown-item" href="/accumulo2-maven-plugin">Accumulo Maven Plugin</a></li>
            <li><a class="dropdown-item" href="/1.10/accumulo_user_manual.html">User Manual (1.10)</a></li>
            <li><a class="dropdown-item" href="/1.10/apidocs">Javadocs (1.10)</a></li>
            <li><a class="dropdown-item" href="/external-docs">External Docs</a></li>
            <li><a class="dropdown-item" href="/docs-archive/">Archive</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Community</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="/contact-us">Contact Us</a></li>
            <li><a class="dropdown-item" href="/how-to-contribute">How To Contribute</a></li>
            <li><a class="dropdown-item" href="/people">People</a></li>
            <li><a class="dropdown-item" href="/related-projects">Related Projects</a></li>
          </ul>
        </li>
        <li class="nav-item"><a class="nav-link" href="/search">Search</a></li>
      </ul>
      <ul class="navbar-nav ms-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
            <img alt="Apache Software Foundation" src="https://www.apache.org/foundation/press/kit/feather.svg" width="15"/>
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="https://www.apache.org">Apache Homepage <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/licenses/">License <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship">Sponsorship <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/security">Security <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/foundation/thanks">Thanks <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct <span class="fa-solid fa-up-right-from-square"></span></a></li>
            <li><a class="dropdown-item" href="https://www.apache.org/events/current-event.html">Current Event <span class="fa-solid fa-up-right-from-square"></span></a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>


  <div class="container">
    <div class="row">
      <div class="col-md-12">

        <div id="non-canonical" style="display: none; background-color: #F0E68C; padding-left: 1em;">
          Visit the official site at: <a href="https://accumulo.apache.org">https://accumulo.apache.org</a>
        </div>
        <div id="content">
          
          <div class="row">
  <div class="col-md-3">
    <div class="accordion sticky-top" id="myAccordion" style="top: 100px;">
      
      
      
        
          
        
          
        
          
        
          
            <div class="accordion-item">
              <div class="accordion-header fs-5 fw-bold" id="headinggetting-started">
                <button class="accordion-button " type="button" data-bs-toggle="collapse" data-bs-target="#collapsegetting-started" aria-expanded="true" aria-controls="collapsegetting-started">
                  Getting started
                </button>
              </div>
              <div id="collapsegetting-started" class="accordion-collapse collapse show" aria-labelledby="headinggetting-started" data-bs-parent="#myAccordion">
                <div class="accordion-body">
                  
                  
                    <div class="row"><a href="/docs/2.x/getting-started/quickstart">Setup</a></div>
                  
                    <div class="row selected"><a href="/docs/2.x/getting-started/design">Design</a></div>
                  
                    <div class="row"><a href="/docs/2.x/getting-started/features">Features</a></div>
                  
                    <div class="row"><a href="/docs/2.x/getting-started/clients">Accumulo Clients</a></div>
                  
                    <div class="row"><a href="/docs/2.x/getting-started/shell">Accumulo Shell</a></div>
                  
                    <div class="row"><a href="/docs/2.x/getting-started/table_design">Table Design</a></div>
                  
                    <div class="row"><a href="/docs/2.x/getting-started/table_configuration">Table Configuration</a></div>
                  
                    <div class="row"><a href="/docs/2.x/getting-started/glossary">Glossary</a></div>
                  
                </div>
              </div>
            </div>
          
        
          
        
          
        
          
        
      
        
          
        
          
        
          
            <div class="accordion-item">
              <div class="accordion-header fs-5 fw-bold" id="headingdevelopment">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsedevelopment" aria-expanded="false" aria-controls="collapsedevelopment">
                  Development
                </button>
              </div>
              <div id="collapsedevelopment" class="accordion-collapse collapse" aria-labelledby="headingdevelopment" data-bs-parent="#myAccordion">
                <div class="accordion-body">
                  
                  
                    <div class="row"><a href="/docs/2.x/development/iterators">Iterators</a></div>
                  
                    <div class="row"><a href="/docs/2.x/development/mapreduce">MapReduce</a></div>
                  
                    <div class="row"><a href="/docs/2.x/development/spark">Spark</a></div>
                  
                    <div class="row"><a href="/docs/2.x/development/development_tools">Development Tools</a></div>
                  
                    <div class="row"><a href="/docs/2.x/development/sampling">Sampling</a></div>
                  
                    <div class="row"><a href="/docs/2.x/development/summaries">Summary Statistics</a></div>
                  
                    <div class="row"><a href="/docs/2.x/development/proxy">Proxy</a></div>
                  
                    <div class="row"><a href="/docs/2.x/development/high_speed_ingest">High-Speed Ingest</a></div>
                  
                </div>
              </div>
            </div>
          
        
          
        
          
        
          
        
          
        
      
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="accordion-item">
              <div class="accordion-header fs-5 fw-bold" id="headingsecurity">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsesecurity" aria-expanded="false" aria-controls="collapsesecurity">
                  Security
                </button>
              </div>
              <div id="collapsesecurity" class="accordion-collapse collapse" aria-labelledby="headingsecurity" data-bs-parent="#myAccordion">
                <div class="accordion-body">
                  
                  
                    <div class="row"><a href="/docs/2.x/security/overview">Security Overview</a></div>
                  
                    <div class="row"><a href="/docs/2.x/security/authentication">Authentication</a></div>
                  
                    <div class="row"><a href="/docs/2.x/security/permissions">Permissions</a></div>
                  
                    <div class="row"><a href="/docs/2.x/security/authorizations">Authorizations</a></div>
                  
                    <div class="row"><a href="/docs/2.x/security/on-disk-encryption">On Disk Encryption</a></div>
                  
                    <div class="row"><a href="/docs/2.x/security/wire-encryption">Wire Encryption</a></div>
                  
                    <div class="row"><a href="/docs/2.x/security/kerberos">Kerberos</a></div>
                  
                </div>
              </div>
            </div>
          
        
          
        
      
        
          
        
          
            <div class="accordion-item">
              <div class="accordion-header fs-5 fw-bold" id="headingconfiguration">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseconfiguration" aria-expanded="false" aria-controls="collapseconfiguration">
                  Configuration
                </button>
              </div>
              <div id="collapseconfiguration" class="accordion-collapse collapse" aria-labelledby="headingconfiguration" data-bs-parent="#myAccordion">
                <div class="accordion-body">
                  
                  
                    <div class="row"><a href="/docs/2.x/configuration/overview">Configuration Overview</a></div>
                  
                    <div class="row"><a href="/docs/2.x/configuration/files">Configuration Files</a></div>
                  
                    <div class="row"><a href="/docs/2.x/configuration/client-properties">Client Properties (2.x)</a></div>
                  
                    <div class="row"><a href="/docs/2.x/configuration/client-properties3">Client Properties (3.x)</a></div>
                  
                    <div class="row"><a href="/docs/2.x/configuration/server-properties">Server Properties (2.x)</a></div>
                  
                    <div class="row"><a href="/docs/2.x/configuration/server-properties3">Server Properties (3.x)</a></div>
                  
                </div>
              </div>
            </div>
          
        
          
        
          
        
          
        
          
        
          
        
      
        
          
            <div class="accordion-item">
              <div class="accordion-header fs-5 fw-bold" id="headingadministration">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseadministration" aria-expanded="false" aria-controls="collapseadministration">
                  Administration
                </button>
              </div>
              <div id="collapseadministration" class="accordion-collapse collapse" aria-labelledby="headingadministration" data-bs-parent="#myAccordion">
                <div class="accordion-body">
                  
                  
                    <div class="row"><a href="/docs/2.x/administration/in-depth-install">In-depth Installation</a></div>
                  
                    <div class="row"><a href="/docs/2.x/administration/monitoring-metrics">Monitoring & Metrics</a></div>
                  
                    <div class="row"><a href="/docs/2.x/administration/fate">FATE</a></div>
                  
                    <div class="row"><a href="/docs/2.x/administration/multivolume">Multi-Volume Installations</a></div>
                  
                    <div class="row"><a href="/docs/2.x/administration/replication">Replication</a></div>
                  
                    <div class="row"><a href="/docs/2.x/administration/caching">Caching</a></div>
                  
                    <div class="row"><a href="/docs/2.x/administration/compaction">Compactions</a></div>
                  
                    <div class="row"><a href="/docs/2.x/administration/upgrading">Upgrading Accumulo</a></div>
                  
                    <div class="row"><a href="/docs/2.x/administration/scan-executors">Scan Executors</a></div>
                  
                    <div class="row"><a href="/docs/2.x/administration/erasure-coding">Erasure Coding</a></div>
                  
                </div>
              </div>
            </div>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="accordion-item">
              <div class="accordion-header fs-5 fw-bold" id="headingtroubleshooting">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsetroubleshooting" aria-expanded="false" aria-controls="collapsetroubleshooting">
                  Troubleshooting
                </button>
              </div>
              <div id="collapsetroubleshooting" class="accordion-collapse collapse" aria-labelledby="headingtroubleshooting" data-bs-parent="#myAccordion">
                <div class="accordion-body">
                  
                  
                    <div class="row"><a href="/docs/2.x/troubleshooting/basic">Basic Troubleshooting</a></div>
                  
                    <div class="row"><a href="/docs/2.x/troubleshooting/advanced">Advanced Troubleshooting</a></div>
                  
                    <div class="row"><a href="/docs/2.x/troubleshooting/tools">Troubleshooting Tools</a></div>
                  
                    <div class="row"><a href="/docs/2.x/troubleshooting/system-metadata-tables">System Metadata Tables</a></div>
                  
                    <div class="row"><a href="/docs/2.x/troubleshooting/performance">Performance</a></div>
                  
                    <div class="row"><a href="/docs/2.x/troubleshooting/tracing">Tracing</a></div>
                  
                    <div class="row"><a href="/docs/2.x/troubleshooting/zookeeper">ZooKeeper</a></div>
                  
                </div>
              </div>
            </div>
          
        
      
    </div>
  </div>
  <div class="col-md-9">
    
    <p>Accumulo 2.x Documentation &gt;&gt; Getting started &gt;&gt; Design</p>
    
    
    <div class="row mt-4">
      <div class="col-md-12 d-flex justify-content-between">
        <h1>Design</h1>
        <a href="https://github.com/apache/accumulo-website/edit/main/_docs-2/getting-started/design.md" role="button"><span class="fa-solid fa-pen-to-square"></span> <small>Edit this page</small></a>
      </div>
    </div>
    
    <h2 id="background">Background</h2>

<p>The design of Apache Accumulo is inspired by Google’s <a href="https://research.google.com/archive/bigtable.html">BigTable paper</a>.</p>

<h2 id="data-model">Data Model</h2>

<p>Accumulo provides a richer data model than simple key-value stores, but is not a
fully relational database. Data is represented as key-value pairs, where the key and
value are comprised of the following elements:</p>

<p><img src="/images/docs/key_value.png" alt="key value pair" /></p>

<p>All elements of the Key and the Value are represented as byte arrays except for
Timestamp, which is a Long. Accumulo sorts keys by element and lexicographically
in ascending order. Timestamps are sorted in descending order so that later
versions of the same Key appear first in a sequential scan. Tables consist of a set of
sorted key-value pairs.</p>

<h2 id="architecture">Architecture</h2>

<p>Accumulo is a distributed data storage and retrieval system and as such consists of
several architectural components, some of which run on many individual servers.
Much of the work Accumulo does involves maintaining certain properties of the
data, such as organization, availability, and integrity, across many commodity-class
machines.</p>

<h2 id="components">Components</h2>

<p>An instance of Accumulo includes many TabletServers, one Garbage Collector process,
one Manager server and many Clients.</p>

<h3 id="tablet-server">Tablet Server</h3>

<p>The TabletServer manages some subset of all the tablets (partitions of tables). This includes receiving writes from clients, persisting writes to a
write-ahead log, sorting new key-value pairs in memory, periodically
flushing sorted key-value pairs to new files in HDFS, and responding
to reads from clients, forming a sorted merge view of all keys and
values from all the files it has created and the sorted in-memory
store.</p>

<p>TabletServers also perform recovery of a tablet
that was previously on a server that failed, reapplying any writes
found in the write-ahead log to the tablet.</p>

<h3 id="garbage-collector">Garbage Collector</h3>

<p>Accumulo processes will share files stored in HDFS. Periodically, the Garbage
Collector will identify files that are no longer needed by any process, and
delete them. Multiple garbage collectors can be run to provide hot-standby support.
They will perform leader election among themselves to choose a single active instance.</p>

<h3 id="manager">Manager</h3>

<p>The Accumulo Manager is responsible for detecting and responding to TabletServer
failure. It tries to balance the load across TabletServer by assigning tablets carefully
and instructing TabletServers to unload tablets when necessary. The Manager ensures all
tablets are assigned to one TabletServer each, and handles table creation, alteration,
and deletion requests from clients. The Manager also coordinates startup, graceful
shutdown and recovery of changes in write-ahead logs when Tablet servers fail.</p>

<p>Multiple managers may be run. The managers will choose among themselves a single manager,
and the others will become backups if the manager should fail.</p>

<h3 id="tracer">Tracer</h3>

<p>The Accumulo Tracer process supports the distributed timing API provided by Accumulo.
One to many of these processes can be run on a cluster which will write the timing
information to a given Accumulo table for future reference. See the
<a href="/docs/2.x/troubleshooting/tracing">tracing documentation</a> for more information.</p>

<h3 id="monitor">Monitor</h3>

<p>The Accumulo Monitor is a web application that provides a wealth of information about
the state of an instance. The Monitor shows graphs and tables which contain information
about read/write rates, cache hit/miss rates, and Accumulo table information such as scan
rate and active/queued compactions. Additionally, the Monitor should always be the first
point of entry when attempting to debug an Accumulo problem as it will show high-level problems
in addition to aggregated errors from all nodes in the cluster. See the <a href="/docs/2.x/administration/monitoring-metrics#monitoring">Accumulo monitor documentation</a>
for more information.</p>

<p>Multiple Monitors can be run to provide hot-standby support in the face of failure. Due to the
forwarding of logs from remote hosts to the Monitor, only one Monitor process should be active
at one time. Leader election will be performed internally to choose the active Monitor.</p>

<h3 id="compactor-experimental">Compactor (experimental)</h3>

<p>The Accumulo Compactor process is an optional application that can be used to run compactions
outside of the TabletServer. One to many Compactors can be run on a cluster and each Compactor
process performs one compaction at a time. The Compactor registers its existence in ZooKeeper
and communicates with the Compaction Coordinator to retrieve its work and to register the
completion status of the compaction. The Compactor process will continue to perform compactions
in situations where normal in-TabletServer compactions would fail, such as TabletServer restart
and Tablet re-hosting.</p>

<h3 id="compaction-coordinator-experimental">Compaction Coordinator (experimental)</h3>

<p>The Accumulo Compaction Coordinator is an optional application that is required to run compactions
outside of the TabletServer. The Coordinator is responsible for communicating with the
TabletServers, to identify what external compaction work needs to be done, and the Compactors
to assign work, get status updates, and cancel running external compactions.</p>

<p>Multiple Coordinators may be run. The Coordinators will choose among themselves a single active Coordinator,
and the others will become backups if the active Coordinator should fail.</p>

<h3 id="scan-server-experimental">Scan Server (experimental)</h3>

<p>The Accumulo Scan Server is an optional application that can be used to run scans on a tablet’s data
outside of the Tablet Server. Many Scan Servers can be run on a cluster and each Scan Server may run
one or more scans concurrently (dependent on configuration). Scans running in a Scan Server do not have
to be concerned about tablet re-hosting or contention with ingest, compactions, and other tablet
maintenance activities. The trade-off when using Scan Server’s is that the tablet hosted within
the ScanServer may not contain the exact same data as the corresponding tablet hosted by the
Tablet Server. The Scan Server does not have any of the Tablet data that may reside within the
in-memory maps and the tablet may reference files that have been compacted as tablet metadata can
be cached within the Scan Server (See Scan Server configuration properties).</p>

<h3 id="client">Client</h3>

<p>Accumulo has a client library that can be used to write applications that write and read
data to/from Accumulo. See the <a href="/docs/2.x/getting-started/clients">Accumulo clients documentation</a> for more information.</p>

<h2 id="data-management">Data Management</h2>

<p>Accumulo stores data in tables, which are partitioned into tablets. Tablets are
partitioned on row boundaries so that all of the columns and values for a particular
row are found together within the same tablet. The Manager assigns Tablets to one
TabletServer at a time. This enables row-level transactions to take place without
using distributed locking or some other complicated synchronization mechanism. As
clients insert and query data, and as machines are added and removed from the
cluster, the Manager migrates tablets to ensure they remain available and that the
ingest and query load is balanced across the cluster.</p>

<p><img src="/images/docs/data_distribution.png" alt="data distribution" /></p>

<h2 id="tablet-server-1">Tablet Server</h2>

<p>When a write arrives at a TabletServer it is written to a Write-Ahead Log and
then inserted into a sorted data structure in memory called a MemTable. When the
MemTable reaches a certain size, the TabletServer writes out the sorted
key-value pairs to a file in HDFS called an <a href="#rfile">RFile</a>. This process is
called a minor compaction. A new MemTable is then created and the fact of the
compaction is recorded in the Write-Ahead Log.</p>

<p>When a request to read data arrives at a TabletServer, the TabletServer does a
binary search across the MemTable as well as the index blocks associated with each RFile
to find the relevant values. If clients are performing a scan, several key-value pairs
are returned to the client in order from the MemTable and data blocks of RFiles by performing
a sorted merge as they are read. If <a href="/docs/2.x/administration/caching">caching</a> is enabled for the table, any index or data
block is stored in the block cache to speed up future scans.</p>

<p><img src="/images/docs/tablet_server.png" alt="tablet server diagram" />
<!-- Source at https://docs.google.com/presentation/d/1yEBNM044FxrzksVfxU35WDbxcVWUYUMy3tgRP75dzus/edit?usp=sharing --></p>

<h2 id="rfile">RFile</h2>

<p>RFile (short for Relative Key File) is a file that contains Accumulo’s sorted key-value
pairs. The file is written to HDFS by Tablet Servers during a minor compaction. RFiles are
organized using the Index Sequential Access Method (ISAM). RFiles consist of data (key/value) block,
index blocks (which are used to find data block), and meta blocks (which contain
metadata for bloom filters and summary statistics). Data in an RFile is separated by
locality group. The diagram below shows the logical view and HDFS file view of an RFile.</p>

<p><img src="/images/docs/rfile_diagram.png" alt="rfile diagram" />
<!-- Source at https://docs.google.com/presentation/d/1w9BgfgUtZ-3M14K-lIgv0UmvnOhVg10Zof6AUi-7pcc/edit?usp=sharing --></p>

<h2 id="compactions">Compactions</h2>

<p>In order to manage the number of files per tablet, periodically the TabletServer
performs Major Compactions of files within a tablet, in which some set of RFiles
are combined into one file. The previous files will eventually be removed by the
Garbage Collector. This also provides an opportunity to permanently remove
deleted key-value pairs by omitting key-value pairs suppressed by a delete entry
when the new file is created. See the <a href="/docs/2.x/getting-started/table_configuration#compaction">compaction documentation</a>
for more information.</p>

<h2 id="splitting">Splitting</h2>

<p>When a table is created it has one tablet. As the table grows its initial
tablet eventually splits into two tablets. It’s likely that one of these
tablets will migrate to another tablet server. As the table continues to grow,
its tablets will continue to split and be migrated. The decision to
automatically split a tablet is based on the size of a tablets files. The
size threshold at which a tablet splits is configurable per table. In addition
to automatic splitting, a user can manually add split points to a table to
create new tablets. Manually splitting a new table can parallelize reads and
writes giving better initial performance without waiting for automatic
splitting.</p>

<p>As data is deleted from a table, tablets may shrink. Over time this can lead
to small or empty tablets. To deal with this, the <a href="/docs/2.x/getting-started/table_configuration#merging-tablets">merging of tablets</a>
was introduced in Accumulo 1.4.</p>

<h2 id="fault-tolerance">Fault-Tolerance</h2>

<p>If a TabletServer fails, the Manager detects it and automatically reassigns the tablets
assigned from the failed server to other servers. Any key-value pairs that were in
memory at the time the TabletServer fails are automatically reapplied from the Write-Ahead
Log(WAL) to prevent any loss of data.</p>

<p>Tablet servers write their WALs directly to HDFS so the logs are available to all tablet
servers for recovery. To make the recovery process efficient, the updates within a log are
grouped by tablet.  TabletServers can quickly apply the mutations from the sorted logs
that are destined for the tablets they have now been assigned.</p>

<p>TabletServer failures are noted on the Manager’s monitor page, accessible via
<code class="language-plaintext highlighter-rouge">http://manager-address:9995/monitor</code>.</p>

<p><img src="/images/docs/failure_handling.png" alt="failure handling" /></p>


    <div class="row mt-4">
      <div class="col-md-12 d-flex justify-content-between">
        <strong>Find documentation for all releases in the <a href="/docs-archive">archive</strong>
        <a href="https://github.com/apache/accumulo-website/edit/main/_docs-2/getting-started/design.md" role="button"><span class="fa-solid fa-pen-to-square"></span> <small>Edit this page</small></a>
      </div>
    </div>
  </div>
</div>

        </div>

        
<footer>

  <p><a href="https://www.apache.org/foundation/contributing"><img src="https://www.apache.org/images/SupportApache-small.png" alt="Support the ASF" id="asf-logo" height="100" /></a></p>

  <p>Copyright © 2011-2024 <a href="https://www.apache.org">The Apache Software Foundation</a>.
Licensed under the <a href="https://www.apache.org/licenses/">Apache License, Version 2.0</a>.</p>

  <p>Apache®, the names of Apache projects and their logos, and the multicolor feather
logo are registered trademarks or trademarks of The Apache Software Foundation
in the United States and/or other countries.</p>

</footer>


      </div>
    </div>
  </div>
</body>
</html>
