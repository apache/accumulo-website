<!DOCTYPE html>
<html lang="en">
<head>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" integrity="sha384-awusxf8AUojygHf2+joICySzB780jVvQaVCAt1clU3QsyAitLGul28Qxb2r1e5g+" crossorigin="anonymous">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/jq-2.2.3/dt-1.10.12/datatables.min.css">
<link href="/css/accumulo.css" rel="stylesheet" type="text/css">

<title>Apache Accumulo 1.8.1</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.datatables.net/v/bs/jq-2.2.3/dt-1.10.12/datatables.min.js"></script>
<script>
  // show location of canonical site if not currently on the canonical site
  $(function() {
    var host = window.location.host;
    if (typeof host !== 'undefined' && host !== 'accumulo.apache.org') {
      $('#non-canonical').show();
    }
  });

  $(function() {
    // decorate section headers with anchors
    return $("h2, h3, h4, h5, h6").each(function(i, el) {
      var $el, icon, id;
      $el = $(el);
      id = $el.attr('id');
      icon = '<i class="fa fa-link"></i>';
      if (id) {
        return $el.append($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));
      }
    });
  });

  // fix sidebar width in documentation
  $(function() {
    var $affixElement = $('div[data-spy="affix"]');
    $affixElement.width($affixElement.parent().width());
  });
</script>

</head>
<body style="padding-top: 100px">

  <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-items">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/"><img id="nav-logo" alt="Apache Accumulo" class="img-responsive" src="/images/accumulo-logo.png" width="200"
        /></a>
    </div>
    <div class="collapse navbar-collapse" id="navbar-items">
      <ul class="nav navbar-nav">
        <li class="nav-link"><a href="/downloads">Download</a></li>
        <li class="nav-link"><a href="/tour">Tour</a></li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Releases<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/release/accumulo-2.0.0/">2.0.0 (Latest)</a></li>
            <li><a href="/release/accumulo-1.9.3/">1.9.3</a></li>
            <li><a href="/release/">Archive</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Documentation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/docs/2.x">User Manual (2.x)</a></li>
            <li><a href="/docs/2.x/apidocs">Javadocs (2.0)</a></li>
            <li><a href="/quickstart-1.x">Quickstart (1.x)</a></li>
            <li><a href="/accumulo2-maven-plugin">Accumulo Maven Plugin</a></li>
            <li><a href="/1.9/accumulo_user_manual.html">User Manual (1.9)</a></li>
            <li><a href="/1.9/apidocs">Javadocs (1.9)</a></li>
            <li><a href="/external-docs">External Docs</a></li>
            <li><a href="/docs-archive/">Archive</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Community<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/contact-us">Contact Us</a></li>
            <li><a href="/how-to-contribute">How To Contribute</a></li>
            <li><a href="/people">People</a></li>
            <li><a href="/related-projects">Related Projects</a></li>
          </ul>
        </li>
        <li class="nav-link"><a href="/search">Search</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#"><img alt="Apache Software Foundation" src="https://www.apache.org/foundation/press/kit/feather.svg" width="15"/><span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="https://www.apache.org">Apache Homepage <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/licenses/">License <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/foundation/sponsorship">Sponsorship <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/security">Security <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/foundation/thanks">Thanks <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/foundation/policies/conduct">Code of Conduct <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/events/current-event.html">Current Event <i class="fa fa-external-link"></i></a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>


  <div class="container">
    <div class="row">
      <div class="col-md-12">

        <div id="non-canonical" style="display: none; background-color: #F0E68C; padding-left: 1em;">
          Visit the official site at: <a href="https://accumulo.apache.org">https://accumulo.apache.org</a>
        </div>
        <div id="content">
          
          <h1 class="title">Apache Accumulo 1.8.1</h1>
          
          <p>26 Feb 2017</p>






<div class="alert alert-danger" style="margin-bottom: 0px;" role="alert">
  <p><strong>WARNING:</strong> This version of Accumulo has critical bugs fixed in newer versions.</p>
  <p>Please check <a class="alert-link" href="/release/">our release archive</a> for a newer version.</p>
</div>


<p>Apache Accumulo 1.8.1 is a maintenance release on the 1.8 version branch. This
release contains changes from more then 40 issues, comprised of bug-fixes,
performance improvements, build quality improvements, and more. See
<a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12312121&amp;version=12335830">JIRA</a> for a complete list.</p>

<p>Below are resources for this release:</p>

<ul>
  <li><a href="/1.8/accumulo_user_manual.html">User Manual</a></li>
  <li><a href="/1.8/apidocs">Javadocs</a></li>
  <li><a href="/1.8/examples">Examples</a></li>
</ul>

<p>In the context of Accumulo’s <a href="http://semver.org">Semantic Versioning</a> <a href="https://github.com/apache/accumulo/blob/rel/1.8.1/README.md#api">guidelines</a>,
this is a “minor version”. This means that new APIs have been created, some
deprecations may have been added, but no deprecated APIs have been removed.
Code written against 1.7.x should work against 1.8.0 – binary compatibility
has been preserved with one exception of an already-deprecated Mock Accumulo
utility class. As always, the Accumulo developers take API compatibility
very seriously and have invested much time to ensure that we meet the promises set forth to our users.</p>

<h2 id="major-changes">Major Changes</h2>

<h3 id="problem-with-scans-right-after-minor-compaction">Problem with scans right after minor compaction</h3>

<p>A bug was found when 2 or more concurrent scans run on a tablet that
has just undergone minor compaction. The minor compaction thread
writes the in-memory map to a local temporary rfile and tries to
switch the current iterators to use it instead of the native map. The
iterator code in the scan thread may also switch itself to use the local
temporary rfile it if notices it before the minor compaction threads
performs the switch. The bug happened shortly after the switch when
one of the iterator threads will get a NegativeArraySizeException.
See <a href="https://issues.apache.org/jira/browse/ACCUMULO-4483">ACCUMULO-4483</a> for more info.</p>

<h3 id="tablet-server-performance-improvement">Tablet Server Performance Improvement</h3>

<p><a href="https://issues.apache.org/jira/browse/ACCUMULO-4458">ACCUMULO-4458</a> mitigated some contention on the Hadoop 
configuration instance backing the XML configs read for SiteConfiguration.<br />
This should improve overall Tablet Server performance.</p>

<h3 id="synchronization-issue-with-deep-copies-of-sources">Synchronization issue with deep copies of sources</h3>

<p>Deep copies of iterator sources were not thread safe and threw
exceptions, mostly down in the ZlibDecompressor library.  The real bug
was in the BoundedRangeFileInputStream.  The read() method
synchronizes on the underlying FSDataInputStream, however the
available() method did not.   See <a href="https://issues.apache.org/jira/browse/ACCUMULO-4391">ACCUMULO-4391</a>.</p>

<h3 id="system-permission-bug-in-thrift-proxy">System permission bug in Thrift Proxy</h3>

<p>The Accumulo Proxy lacked support for the following system permissions:</p>

<ul>
  <li>System.CREATE_NAMESPACE</li>
  <li>System.DROP_NAMESPACE</li>
  <li>System.ALTER_NAMESPACE</li>
  <li>System.OBTAIN_DELEGATION_TOKEN</li>
</ul>

<p>Ticket is <a href="https://issues.apache.org/jira/browse/ACCUMULO-4519">ACCUMULO-4519</a>.</p>

<h3 id="shell-compaction-file-selection-options-can-block">Shell compaction file selection options can block</h3>

<p>The block happens when the tablet lock is held.  The tablet lock is
meant to protect changes to the tablets internal metadata, and
blocking operations should not occur while this lock is held.  The
compaction command has options to select files based on some
criteria, some of which required blocking operations.  This issue is
fixed in <a href="https://issues.apache.org/jira/browse/ACCUMULO-4572">ACCUMULO-4572</a>.</p>

<h3 id="hostregextableloadbalancer-used-stale-information">HostRegexTableLoadBalancer used stale information</h3>

<p>The HostRegexTableLoadBalancer maintains an internal mapping of tablet
server pools and tablet server status. It was updated at a
configurable interval initially as an optimization. Unfortunately it
had the negative side effect of providing the assignment and balance
operations with stale information.  This lead to a constant shuffling
of tablets.  The configuration property was removed so that
assign/balance methods get updated information every time.  See
<a href="https://issues.apache.org/jira/browse/ACCUMULO-4576">ACCUMULO-4576</a>.</p>

<h3 id="modify-tableoperations-online-to-check-for-table-state">Modify TableOperations online to check for table state</h3>

<p>The table operations online operation executes as a fate
operation. If a transaction lock for the table is currently held,
this operation will block even if no action is needed. 
<a href="https://issues.apache.org/jira/browse/ACCUMULO-4574">ACCUMULO-4574</a> changes the behavior of the online
operation to a NOOP if the table is already in the requested state.
This returns immediately without queuing a fate operation.</p>

<h2 id="other-notable-changes">Other Notable Changes</h2>

<ul>
  <li><a href="https://issues.apache.org/jira/browse/ACCUMULO-4488">ACCUMULO-4488</a> Fix gap in user manual on Kerberos for clients</li>
  <li><a href="https://issues.apache.org/jira/browse/ACCUMULO-2724">ACCUMULO-2724</a> CollectTabletStats had multiple -t parameter</li>
  <li><a href="https://issues.apache.org/jira/browse/ACCUMULO-4431">ACCUMULO-4431</a> Log what random is chosen for a tserver.</li>
  <li><a href="https://issues.apache.org/jira/browse/ACCUMULO-4494">ACCUMULO-4494</a> Include column family seeks in the Iterator Test Harness</li>
  <li><a href="https://issues.apache.org/jira/browse/ACCUMULO-4549">ACCUMULO-4549</a> Remove duplicate init functions in TabletBalancer</li>
  <li><a href="https://issues.apache.org/jira/browse/ACCUMULO-4467">ACCUMULO-4467</a> Random Walk broken because of unmet dependency on commons-math</li>
  <li><a href="https://issues.apache.org/jira/browse/ACCUMULO-4578">ACCUMULO-4578</a> Cancel compaction FATE operation does not release namespace lock</li>
  <li><a href="https://issues.apache.org/jira/browse/ACCUMULO-4505">ACCUMULO-4505</a> Shell still reads accumulo-site.xml when using Zookeeper CLI options</li>
  <li><a href="https://issues.apache.org/jira/browse/ACCUMULO-4535">ACCUMULO-4535</a> HostRegexTableLoadBalancer fails with NullPointerException</li>
  <li><a href="https://issues.apache.org/jira/browse/ACCUMULO-4575">ACCUMULO-4575</a> Concurrent table delete operations leave orphan fate transaction locks</li>
</ul>

<h2 id="upgrading">Upgrading</h2>

<p>Upgrades from 1.7 to 1.8 are possible with little effort as no changes were made at the data layer and RPC changes
were made in a backwards-compatible way. The recommended way is to stop Accumulo 1.7, perform the Accumulo upgrade to
1.8, and then start 1.8. Like previous versions, after 1.8 is started on a 1.7 instance, a one-time upgrade will
happen by the Master which will prevent a downgrade back to 1.7. Upgrades are still one way. Upgrades from versions
prior to 1.7 to 1.8 should follow the below path to 1.7 and then perform the upgrade to 1.8 – direct upgrades to 1.8
for versions other than 1.7 are untested.</p>

<p>Existing configuration files from 1.7 should be compared against the examples provided in 1.8. The 1.7 configuration
files should all function with 1.8 code, but you will likely want to include changes found in the 
<a href="/release/accumulo-1.8.0/">1.8.0 release notes</a> and these release notes for 1.8.1.</p>

<p>For upgrades from prior to 1.7, follow the upgrade instructions to 1.7 first.</p>

<h2 id="testing">Testing</h2>

<p>Each unit and functional test only runs on a single node, while the RandomWalk
and Continuous Ingest tests run on any number of nodes. <em>Agitation</em> refers to
randomly restarting Accumulo processes and Hadoop Datanode processes, and, in
HDFS High-Availability instances, forcing NameNode failover.</p>

<table id="release_notes_testing" class="table">
  <thead>
    <tr>
      <th>OS/Environment</th>
      <th>Hadoop</th>
      <th>Nodes</th>
      <th>ZooKeeper</th>
      <th>HDFS HA</th>
      <th>Tests</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CentOS7/openJDK1.8.0_121/EC2; 1 m3.xlarge leader, 8 d2.xlarge workers</td>
      <td>2.7.3</td>
      <td>9</td>
      <td>3.4.9</td>
      <td>No</td>
      <td>24 HR Continuous Ingest without Agitation.</td>
    </tr>
    <tr>
      <td>CentOS7/openJDK1.8.0_121/EC2; 1 m3.xlarge leader, 8 d2.xlarge workers</td>
      <td>2.7.3</td>
      <td>9</td>
      <td>3.4.9</td>
      <td>No</td>
      <td>24 HR Continuous Ingest with Agitation.</td>
    </tr>
  </tbody>
</table>



<p><strong>View all releases in the <a href="/release/">archive</a></strong></p>

        </div>

        
<footer>

  <p><a href="https://www.apache.org/foundation/contributing"><img src="https://www.apache.org/images/SupportApache-small.png" alt="Support the ASF" id="asf-logo" height="100" /></a></p>

  <p>Copyright © 2011-2020 <a href="https://www.apache.org">The Apache Software Foundation</a>.
Licensed under the <a href="https://www.apache.org/licenses/">Apache License, Version 2.0</a>.</p>

  <p>Apache®, the names of Apache projects and their logos, and the multicolor feather
logo are registered trademarks or trademarks of The Apache Software Foundation
in the United States and/or other countries.</p>

</footer>


      </div>
    </div>
  </div>
</body>
</html>
