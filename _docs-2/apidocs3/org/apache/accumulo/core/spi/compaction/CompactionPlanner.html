<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>CompactionPlanner (Apache Accumulo Project 3.0.0 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.accumulo.core.spi.compaction, interface: CompactionPlanner">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/CompactionPlanner.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.accumulo.core.spi.compaction</a></div>
<h1 title="Interface CompactionPlanner" class="title">Interface CompactionPlanner</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="DefaultCompactionPlanner.html" title="class in org.apache.accumulo.core.spi.compaction">DefaultCompactionPlanner</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">CompactionPlanner</span></div>
<div class="block">Plans compaction work for a compaction service.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>2.1.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list-long">
<li><a href="package-summary.html"><code>org.apache.accumulo.core.spi.compaction</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Interface</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="CompactionPlanner.InitParameters.html" class="type-name-link" title="interface in org.apache.accumulo.core.spi.compaction">CompactionPlanner.InitParameters</a></code></div>
<div class="col-last even-row-color">
<div class="block">This interface exists so the API can evolve and additional parameters can be passed to the
 method in the future.</div>
</div>
<div class="col-first odd-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="CompactionPlanner.PlanningParameters.html" class="type-name-link" title="interface in org.apache.accumulo.core.spi.compaction">CompactionPlanner.PlanningParameters</a></code></div>
<div class="col-last odd-row-color">
<div class="block">This interface exists so the API can evolve and additional parameters can be passed to the
 method in the future.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#init(org.apache.accumulo.core.spi.compaction.CompactionPlanner.InitParameters)" class="member-name-link">init</a><wbr>(<a href="CompactionPlanner.InitParameters.html" title="interface in org.apache.accumulo.core.spi.compaction">CompactionPlanner.InitParameters</a>&nbsp;params)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="CompactionPlan.html" title="interface in org.apache.accumulo.core.spi.compaction">CompactionPlan</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#makePlan(org.apache.accumulo.core.spi.compaction.CompactionPlanner.PlanningParameters)" class="member-name-link">makePlan</a><wbr>(<a href="CompactionPlanner.PlanningParameters.html" title="interface in org.apache.accumulo.core.spi.compaction">CompactionPlanner.PlanningParameters</a>&nbsp;params)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">
 Plan what work a compaction service should do.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="init(org.apache.accumulo.core.spi.compaction.CompactionPlanner.InitParameters)">
<h3>init</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">init</span><wbr><span class="parameters">(<a href="CompactionPlanner.InitParameters.html" title="interface in org.apache.accumulo.core.spi.compaction">CompactionPlanner.InitParameters</a>&nbsp;params)</span></div>
</section>
</li>
<li>
<section class="detail" id="makePlan(org.apache.accumulo.core.spi.compaction.CompactionPlanner.PlanningParameters)">
<h3>makePlan</h3>
<div class="member-signature"><span class="return-type"><a href="CompactionPlan.html" title="interface in org.apache.accumulo.core.spi.compaction">CompactionPlan</a></span>&nbsp;<span class="element-name">makePlan</span><wbr><span class="parameters">(<a href="CompactionPlanner.PlanningParameters.html" title="interface in org.apache.accumulo.core.spi.compaction">CompactionPlanner.PlanningParameters</a>&nbsp;params)</span></div>
<div class="block"><p>
 Plan what work a compaction service should do. The kind of compaction returned by
 <a href="CompactionPlanner.PlanningParameters.html#getKind()"><code>CompactionPlanner.PlanningParameters.getKind()</code></a> determines what must be done with the files returned by
 <a href="CompactionPlanner.PlanningParameters.html#getCandidates()"><code>CompactionPlanner.PlanningParameters.getCandidates()</code></a>. The following are the expectations for the
 candidates for each kind.

 <ul>
 <li>CompactionKind.SYSTEM The planner is not required to do anything with the candidates and
 can choose to compact zero or more of them. The candidates may represent a subset of all the
 files in the case where a user compaction is in progress or other compactions are running.
 <li>CompactionKind.USER and CompactionKind.SELECTED. The planner is required to eventually
 compact all candidates. Its ok to return a compaction plan that compacts a subset. When the
 planner compacts a subset, it will eventually be called again later. When it is called later
 the candidates will contain the files it did not compact and the results of any previous
 compactions it scheduled. The planner must eventually compact all of the files in the candidate
 set down to a single file. The compaction service will keep calling the planner until it does.
 <li>CompactionKind.CHOP. The planner is required to eventually compact all candidates. One
 major difference with USER compactions is this kind is not required to compact all files to a
 single file. It is ok to return a compaction plan that compacts a subset of the candidates.
 When the planner compacts a subset, it will eventually be called later. When it is called later
 the candidates will contain the files it did not compact.
 </ul>

 <p>
 For a chop compaction assume the following happens.
 <ol>
 <li>The candidate set passed to makePlan contains the files <code>[F1,F2,F3,F4]</code> and kind is
 CHOP
 <li>The planner returns a job to compact files <code>[F1,F2]</code> on executor E1
 <li>The compaction runs compacting <code>[F1,F2]</code> into file <code>[F5]</code>
 </ol>

 <p>
 For the case above, eventually the planner will called again with a candidate set of
 <code>[F3,F4]</code> and it must eventually compact those two files.

 <p>
 For a user and selector compaction assume the same thing happens, it will result in a slightly
 different outcome.
 <ol>
 <li>The candidate set passed to makePlan contains the files <code>[F1,F2,F3,F4]</code> and kind is
 USER
 <li>The planner returns a job to compact files <code>[F1,F2]</code> on executor E1
 <li>The compaction runs compacting <code>[F1,F2]</code> into file <code>[F5]</code>
 </ol>

 <p>
 For the case above, eventually the planner will called again with a candidate set of
 <code>[F3,F4,F5]</code> and it must eventually compact those three files to one. The difference with
 CHOP compactions is that the result of intermediate compactions are included in the candidate
 set.

 <p>
 When a planner returns a compactions plan, task will be queued on executors. Previously queued
 task that do not match the latest plan are removed. The planner is called periodically,
 whenever a new file is added, and whenever a compaction finishes.

 <p>
 Use <a href="CompactionPlanner.PlanningParameters.html#createPlanBuilder()"><code>CompactionPlanner.PlanningParameters.createPlanBuilder()</code></a> to build the plan this function returns.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="CompactionKind.html" title="enum in org.apache.accumulo.core.spi.compaction"><code>CompactionKind</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2011&#x2013;2023 <a href="https://www.apache.org">The Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
