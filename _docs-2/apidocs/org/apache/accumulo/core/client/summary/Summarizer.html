<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (15) on Wed Dec 23 22:39:02 EST 2020 -->
<title>Summarizer (Apache Accumulo Project 2.0.1 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2020-12-23">
<meta name="description" content="declaration: package: org.apache.accumulo.core.client.summary, interface: Summarizer">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var data = {"i0":6,"i1":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "alt-color";
var rowColor = "row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar.top">
<div class="skip-nav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.top.firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Summarizer.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip.navbar.top">
<!--   -->
</span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.accumulo.core.client.summary</a></div>
<h1 title="Interface Summarizer" class="title">Interface Summarizer</h1>
</div>
<section class="description">
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="summarizers/AuthorizationSummarizer.html" title="class in org.apache.accumulo.core.client.summary.summarizers">AuthorizationSummarizer</a></code>, <code><a href="CountingSummarizer.html" title="class in org.apache.accumulo.core.client.summary">CountingSummarizer</a></code>, <code><a href="summarizers/DeletesSummarizer.html" title="class in org.apache.accumulo.core.client.summary.summarizers">DeletesSummarizer</a></code>, <code><a href="summarizers/EntryLengthSummarizer.html" title="class in org.apache.accumulo.core.client.summary.summarizers">EntryLengthSummarizer</a></code>, <code><a href="summarizers/FamilySummarizer.html" title="class in org.apache.accumulo.core.client.summary.summarizers">FamilySummarizer</a></code>, <code><a href="summarizers/VisibilitySummarizer.html" title="class in org.apache.accumulo.core.client.summary.summarizers">VisibilitySummarizer</a></code></dd>
</dl>
<hr>
<pre>public interface <span class="type-name-label">Summarizer</span></pre>
<div class="block">Instances of this interface can be configured for Accumulo tables. When Accumulo compacts files,
 it will use this Factory to create <a href="Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Collector</code></a> and <a href="Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Combiner</code></a> objects to generate
 summary information about the data in the file.

 <p>
 In order to merge summary information from multiple files, Accumulo will use this factory to
 create a <a href="Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Combiner</code></a> object.

 <p>
 Below is an example of a very simple summarizer that will compute the number of deletes, total
 number of keys, min timestamp and max timestamp.

 <pre>
 <code>
   public class BasicSummarizer implements Summarizer {

     public static final String DELETES_STAT = &quot;deletes&quot;;
     public static final String MIN_STAMP_STAT = &quot;minStamp&quot;;
     public static final String MAX_STAMP_STAT = &quot;maxStamp&quot;;
     public static final String TOTAL_STAT = &quot;total&quot;;

     &#064;Override
     public Collector collector(SummarizerConfiguration sc) {
       return new Collector() {

         private long minStamp = Long.MAX_VALUE;
         private long maxStamp = Long.MIN_VALUE;
         private long deletes = 0;
         private long total = 0;

         &#064;Override
         public void accept(Key k, Value v) {
           if (k.getTimestamp() &lt; minStamp) {
             minStamp = k.getTimestamp();
           }

           if (k.getTimestamp() &gt; maxStamp) {
             maxStamp = k.getTimestamp();
           }

           if (k.isDeleted()) {
             deletes++;
           }

           total++;
         }

         &#064;Override
         public void summarize(StatisticConsumer sc) {
           sc.accept(MIN_STAMP_STAT, minStamp);
           sc.accept(MAX_STAMP_STAT, maxStamp);
           sc.accept(DELETES_STAT, deletes);
           sc.accept(TOTAL_STAT, total);
         }
       };
     }

     &#064;Override
     public Combiner combiner(SummarizerConfiguration sc) {
       return (stats1, stats2) -&gt; {
         stats1.merge(DELETES_STAT, stats2.get(DELETES_STAT), Long::sum);
         stats1.merge(TOTAL_STAT, stats2.get(TOTAL_STAT), Long::sum);
         stats1.merge(MIN_STAMP_STAT, stats2.get(MIN_STAMP_STAT), Long::min);
         stats1.merge(MAX_STAMP_STAT, stats2.get(MAX_STAMP_STAT), Long::max);
       };
     }
   }
 </code>
 </pre>

 <p>
 Below is an example summarizer that counts the log of the value length.

 <pre>
 <code>
 public class ValueLogLengthSummarizer implements Summarizer {

  &#64;Override
  public Collector collector(SummarizerConfiguration sc) {

    return new Collector(){

      long[] counts = new long[32];

      &#64;Override
      public void accept(Key k, Value v) {
        int idx;
        if(v.getSize() == 0)
          idx = 0;
        else
          idx = IntMath.log2(v.getSize(), RoundingMode.UP);  //IntMath is from Guava

        counts[idx]++;
      }

      &#64;Override
      public void summarize(StatisticConsumer sc) {
        for (int i = 0; i &lt; counts.length; i++) {
          if(counts[i] &gt; 0) {
            sc.accept(""+(1&lt;&lt;i), counts[i]);
          }
        }
      }
    };
  }

  &#64;Override
  public Combiner combiner(SummarizerConfiguration sc) {
    return (m1, m2) -&gt; m2.forEach((k,v) -&gt; m1.merge(k, v, Long::sum));
  }
 }
 </code>
 </pre>

 <p>
 The reason a Summarizer is a factory for a Collector and Combiner is to make it very clear in the
 API that Accumulo uses them independently at different times. Therefore its not advisable to
 share internal state between the Collector and Combiner. The example implementation shows that
 the Collectors design allows for very efficient collection of specialized summary information.
 Creating <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link"><code>String</code></a> + <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html" title="class or interface in java.lang" class="external-link"><code>Long</code></a> pairs is deferred until the summarize method is called.

 <p>
 Summary data can be used by Compaction Strategies to decide which files to compact.

 <p>
 Summary data is persisted, so ideally the same summarizer class with the same options should
 always produce the same results. If you need to change the behavior of a summarizer, then
 consider doing this by adding a new option. If the same summarizer is configured twice with
 different options, then Accumulo will store and merge each one separately. This can allow old and
 new behavior to coexists simultaneously.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>2.0.0</dd>
<dt>See Also:</dt>
<dd><a href="../admin/TableOperations.html#summaries(java.lang.String)"><code>TableOperations.summaries(String)</code></a>, 
<a href="../admin/TableOperations.html#addSummarizers(java.lang.String,org.apache.accumulo.core.client.summary.SummarizerConfiguration...)"><code>TableOperations.addSummarizers(String, SummarizerConfiguration...)</code></a>, 
<a href="../admin/TableOperations.html#listSummarizers(java.lang.String)"><code>TableOperations.listSummarizers(String)</code></a>, 
<a href="../admin/TableOperations.html#removeSummarizers(java.lang.String,java.util.function.Predicate)"><code>TableOperations.removeSummarizers(String, java.util.function.Predicate)</code></a>, 
<a href="../rfile/RFile.html#summaries()"><code>RFile.summaries()</code></a>, 
<a href="SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary"><code>SummarizerConfiguration</code></a></dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested.class.summary">
<h2>Nested Class Summary</h2>
<div class="member-summary">
<table class="summary-table">
<caption><span>Nested Classes</span></caption>
<thead>
<tr>
<th class="col-first" scope="col">Modifier and Type</th>
<th class="col-second" scope="col">Interface</th>
<th class="col-last" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="alt-color">
<td class="col-first"><code>static interface&nbsp;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Collector</a></span></code></th>
<td class="col-last">
<div class="block">When Accumulo calls methods in this interface, it will call <a href="Summarizer.Collector.html#accept(org.apache.accumulo.core.data.Key,org.apache.accumulo.core.data.Value)"><code>Summarizer.Collector.accept(Key, Value)</code></a> zero or
 more times and then call <a href="Summarizer.Collector.html#summarize(org.apache.accumulo.core.client.summary.Summarizer.StatisticConsumer)"><code>Summarizer.Collector.summarize(Summarizer.StatisticConsumer)</code></a> once.</div>
</td>
</tr>
<tr class="row-color">
<td class="col-first"><code>static interface&nbsp;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Combiner</a></span></code></th>
<td class="col-last">
<div class="block">A Combiner is used to merge statistics emitted from
 <a href="Summarizer.Collector.html#summarize(org.apache.accumulo.core.client.summary.Summarizer.StatisticConsumer)"><code>Summarizer.Collector.summarize(Summarizer.StatisticConsumer)</code></a> and from previous invocations of
 itself.</div>
</td>
</tr>
<tr class="alt-color">
<td class="col-first"><code>static interface&nbsp;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="Summarizer.StatisticConsumer.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.StatisticConsumer</a></span></code></th>
<td class="col-last">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method.summary">
<h2>Method Summary</h2>
<div class="member-summary" id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="active-table-tab">All Methods</button><button role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="table-tab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t3" class="table-tab" onclick="show(4);">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<table class="summary-table" aria-labelledby="t0">
<thead>
<tr>
<th class="col-first" scope="col">Modifier and Type</th>
<th class="col-second" scope="col">Method</th>
<th class="col-last" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="alt-color" id="i0">
<td class="col-first"><code><a href="Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Collector</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#collector(org.apache.accumulo.core.client.summary.SummarizerConfiguration)">collector</a></span>&#8203;(<a href="SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary">SummarizerConfiguration</a>&nbsp;sc)</code></th>
<td class="col-last">
<div class="block">Factory method that creates a <a href="Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Collector</code></a> based on configuration.</div>
</td>
</tr>
<tr class="row-color" id="i1">
<td class="col-first"><code><a href="Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Combiner</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#combiner(org.apache.accumulo.core.client.summary.SummarizerConfiguration)">combiner</a></span>&#8203;(<a href="SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary">SummarizerConfiguration</a>&nbsp;sc)</code></th>
<td class="col-last">
<div class="block">Factory method that creates a <a href="Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Combiner</code></a>.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method.detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="collector(org.apache.accumulo.core.client.summary.SummarizerConfiguration)">
<h3>collector</h3>
<div class="member-signature"><span class="return-type"><a href="Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Collector</a></span>&nbsp;<span class="member-name">collector</span>&#8203;(<span class="parameters"><a href="SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary">SummarizerConfiguration</a>&nbsp;sc)</span></div>
<div class="block">Factory method that creates a <a href="Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Collector</code></a> based on configuration. Each <a href="Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Collector</code></a>
 created by this method should be independent and have its own internal state. Accumulo uses a
 Collector to generate summary statistics about a sequence of key values written to a file.</div>
</section>
</li>
<li>
<section class="detail" id="combiner(org.apache.accumulo.core.client.summary.SummarizerConfiguration)">
<h3>combiner</h3>
<div class="member-signature"><span class="return-type"><a href="Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Combiner</a></span>&nbsp;<span class="member-name">combiner</span>&#8203;(<span class="parameters"><a href="SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary">SummarizerConfiguration</a>&nbsp;sc)</span></div>
<div class="block">Factory method that creates a <a href="Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Combiner</code></a>. Accumulo will only use the created Combiner to
 merge data from <a href="Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Collector</code></a>s created using the same <a href="SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary"><code>SummarizerConfiguration</code></a>.</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottom-nav" id="navbar.bottom">
<div class="skip-nav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.bottom.firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Summarizer.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<span class="skip-nav" id="skip.navbar.bottom">
<!--   -->
</span></nav>
<p class="legal-copy"><small>Copyright &#169; 2011&#x2013;2020 <a href="https://www.apache.org">The Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
