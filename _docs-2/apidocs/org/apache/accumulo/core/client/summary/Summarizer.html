<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_191) on Thu Jan 31 13:05:11 EST 2019 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Summarizer (Apache Accumulo Project 2.0.0-alpha-2 API)</title>
<meta name="date" content="2019-01-31">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Summarizer (Apache Accumulo Project 2.0.0-alpha-2 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Summarizer.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/accumulo/core/client/summary/CountingSummarizer.Converter.html" title="interface in org.apache.accumulo.core.client.summary"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/accumulo/core/client/summary/Summarizer.html" target="_top">Frames</a></li>
<li><a href="Summarizer.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.accumulo.core.client.summary</div>
<h2 title="Interface Summarizer" class="title">Interface Summarizer</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../../../org/apache/accumulo/core/client/summary/summarizers/AuthorizationSummarizer.html" title="class in org.apache.accumulo.core.client.summary.summarizers">AuthorizationSummarizer</a>, <a href="../../../../../../org/apache/accumulo/core/client/summary/CountingSummarizer.html" title="class in org.apache.accumulo.core.client.summary">CountingSummarizer</a>, <a href="../../../../../../org/apache/accumulo/core/client/summary/summarizers/DeletesSummarizer.html" title="class in org.apache.accumulo.core.client.summary.summarizers">DeletesSummarizer</a>, <a href="../../../../../../org/apache/accumulo/core/client/summary/summarizers/EntryLengthSummarizer.html" title="class in org.apache.accumulo.core.client.summary.summarizers">EntryLengthSummarizer</a>, <a href="../../../../../../org/apache/accumulo/core/client/summary/summarizers/FamilySummarizer.html" title="class in org.apache.accumulo.core.client.summary.summarizers">FamilySummarizer</a>, <a href="../../../../../../org/apache/accumulo/core/client/summary/summarizers/VisibilitySummarizer.html" title="class in org.apache.accumulo.core.client.summary.summarizers">VisibilitySummarizer</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">Summarizer</span></pre>
<div class="block">Instances of this interface can be configured for Accumulo tables. When Accumulo compacts files,
 it will use this Factory to create <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Collector</code></a> and <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Combiner</code></a> objects to generate
 summary information about the data in the file.

 <p>
 In order to merge summary information from multiple files, Accumulo will use this factory to
 create a <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Combiner</code></a> object.

 <p>
 Below is an example of a very simple summarizer that will compute the number of deletes, total
 number of keys, min timestamp and max timestamp.

 <pre>
 <code>
   public class BasicSummarizer implements Summarizer {

     public static final String DELETES_STAT = &quot;deletes&quot;;
     public static final String MIN_STAMP_STAT = &quot;minStamp&quot;;
     public static final String MAX_STAMP_STAT = &quot;maxStamp&quot;;
     public static final String TOTAL_STAT = &quot;total&quot;;

     &#064;Override
     public Collector collector(SummarizerConfiguration sc) {
       return new Collector() {

         private long minStamp = Long.MAX_VALUE;
         private long maxStamp = Long.MIN_VALUE;
         private long deletes = 0;
         private long total = 0;

         &#064;Override
         public void accept(Key k, Value v) {
           if (k.getTimestamp() &lt; minStamp) {
             minStamp = k.getTimestamp();
           }

           if (k.getTimestamp() &gt; maxStamp) {
             maxStamp = k.getTimestamp();
           }

           if (k.isDeleted()) {
             deletes++;
           }

           total++;
         }

         &#064;Override
         public void summarize(StatisticConsumer sc) {
           sc.accept(MIN_STAMP_STAT, minStamp);
           sc.accept(MAX_STAMP_STAT, maxStamp);
           sc.accept(DELETES_STAT, deletes);
           sc.accept(TOTAL_STAT, total);
         }
       };
     }

     &#064;Override
     public Combiner combiner(SummarizerConfiguration sc) {
       return (stats1, stats2) -&gt; {
         stats1.merge(DELETES_STAT, stats2.get(DELETES_STAT), Long::sum);
         stats1.merge(TOTAL_STAT, stats2.get(TOTAL_STAT), Long::sum);
         stats1.merge(MIN_STAMP_STAT, stats2.get(MIN_STAMP_STAT), Long::min);
         stats1.merge(MAX_STAMP_STAT, stats2.get(MAX_STAMP_STAT), Long::max);
       };
     }
   }
 </code>
 </pre>

 <p>
 Below is an example summarizer that counts the log of the value length.

 <pre>
 <code>
 public class ValueLogLengthSummarizer implements Summarizer {

  &#64;Override
  public Collector collector(SummarizerConfiguration sc) {

    return new Collector(){

      long[] counts = new long[32];

      &#64;Override
      public void accept(Key k, Value v) {
        int idx;
        if(v.getSize() == 0)
          idx = 0;
        else
          idx = IntMath.log2(v.getSize(), RoundingMode.UP);  //IntMath is from Guava

        counts[idx]++;
      }

      &#64;Override
      public void summarize(StatisticConsumer sc) {
        for (int i = 0; i &lt; counts.length; i++) {
          if(counts[i] &gt; 0) {
            sc.accept(""+(1&lt;&lt;i), counts[i]);
          }
        }
      }
    };
  }

  &#64;Override
  public Combiner combiner(SummarizerConfiguration sc) {
    return (m1, m2) -&gt; m2.forEach((k,v) -&gt; m1.merge(k, v, Long::sum));
  }
 }
 </code>
 </pre>

 <p>
 The reason a Summarizer is a factory for a Collector and Combiner is to make it very clear in the
 API that Accumulo uses them independently at different times. Therefore its not advisable to
 share internal state between the Collector and Combiner. The example implementation shows that
 the Collectors design allows for very efficient collection of specialized summary information.
 Creating <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang"><code>String</code></a> + <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang"><code>Long</code></a> pairs is deferred until the summarize method is called.

 <p>
 Summary data can be used by Compaction Strategies to decide which files to compact.

 <p>
 Summary data is persisted, so ideally the same summarizer class with the same options should
 always produce the same results. If you need to change the behavior of a summarizer, then
 consider doing this by adding a new option. If the same summarizer is configured twice with
 different options, then Accumulo will store and merge each one separately. This can allow old and
 new behavior to coexists simultaneously.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.0.0</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../org/apache/accumulo/core/client/admin/TableOperations.html#summaries-java.lang.String-"><code>TableOperations.summaries(String)</code></a>, 
<a href="../../../../../../org/apache/accumulo/core/client/admin/TableOperations.html#addSummarizers-java.lang.String-org.apache.accumulo.core.client.summary.SummarizerConfiguration...-"><code>TableOperations.addSummarizers(String, SummarizerConfiguration...)</code></a>, 
<a href="../../../../../../org/apache/accumulo/core/client/admin/TableOperations.html#listSummarizers-java.lang.String-"><code>TableOperations.listSummarizers(String)</code></a>, 
<a href="../../../../../../org/apache/accumulo/core/client/admin/TableOperations.html#removeSummarizers-java.lang.String-java.util.function.Predicate-"><code>TableOperations.removeSummarizers(String, java.util.function.Predicate)</code></a>, 
<a href="../../../../../../org/apache/accumulo/core/client/rfile/RFile.html#summaries--"><code>RFile.summaries()</code></a>, 
<a href="../../../../../../org/apache/accumulo/core/client/summary/SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary"><code>SummarizerConfiguration</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Interface and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Collector</a></span></code>
<div class="block">When Accumulo calls methods in this interface, it will call <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html#accept-org.apache.accumulo.core.data.Key-org.apache.accumulo.core.data.Value-"><code>Summarizer.Collector.accept(Key, Value)</code></a> zero or
 more times and then call <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html#summarize-org.apache.accumulo.core.client.summary.Summarizer.StatisticConsumer-"><code>Summarizer.Collector.summarize(Summarizer.StatisticConsumer)</code></a> once.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Combiner</a></span></code>
<div class="block">A Combiner is used to merge statistics emitted from
 <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html#summarize-org.apache.accumulo.core.client.summary.Summarizer.StatisticConsumer-"><code>Summarizer.Collector.summarize(Summarizer.StatisticConsumer)</code></a> and from previous invocations of
 itself.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.StatisticConsumer.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.StatisticConsumer</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Collector</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.html#collector-org.apache.accumulo.core.client.summary.SummarizerConfiguration-">collector</a></span>(<a href="../../../../../../org/apache/accumulo/core/client/summary/SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary">SummarizerConfiguration</a>&nbsp;sc)</code>
<div class="block">Factory method that creates a <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Collector</code></a> based on configuration.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Combiner</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.html#combiner-org.apache.accumulo.core.client.summary.SummarizerConfiguration-">combiner</a></span>(<a href="../../../../../../org/apache/accumulo/core/client/summary/SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary">SummarizerConfiguration</a>&nbsp;sc)</code>
<div class="block">Factory method that creates a <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Combiner</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="collector-org.apache.accumulo.core.client.summary.SummarizerConfiguration-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>collector</h4>
<pre><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Collector</a>&nbsp;collector(<a href="../../../../../../org/apache/accumulo/core/client/summary/SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary">SummarizerConfiguration</a>&nbsp;sc)</pre>
<div class="block">Factory method that creates a <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Collector</code></a> based on configuration. Each <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Collector</code></a>
 created by this method should be independent and have its own internal state. Accumulo uses a
 Collector to generate summary statistics about a sequence of key values written to a file.</div>
</li>
</ul>
<a name="combiner-org.apache.accumulo.core.client.summary.SummarizerConfiguration-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>combiner</h4>
<pre><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary">Summarizer.Combiner</a>&nbsp;combiner(<a href="../../../../../../org/apache/accumulo/core/client/summary/SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary">SummarizerConfiguration</a>&nbsp;sc)</pre>
<div class="block">Factory method that creates a <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Combiner.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Combiner</code></a>. Accumulo will only use the created Combiner to
 merge data from <a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><code>Summarizer.Collector</code></a>s created using the same <a href="../../../../../../org/apache/accumulo/core/client/summary/SummarizerConfiguration.html" title="class in org.apache.accumulo.core.client.summary"><code>SummarizerConfiguration</code></a>.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Summarizer.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/accumulo/core/client/summary/CountingSummarizer.Converter.html" title="interface in org.apache.accumulo.core.client.summary"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/accumulo/core/client/summary/Summarizer.Collector.html" title="interface in org.apache.accumulo.core.client.summary"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/accumulo/core/client/summary/Summarizer.html" target="_top">Frames</a></li>
<li><a href="Summarizer.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2011&#x2013;2019 <a href="https://www.apache.org">The Apache Software Foundation</a>. All rights reserved.</small></p>
</body>
</html>
